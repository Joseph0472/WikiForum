{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nexports.__esModule = true;\n\nvar react_1 = __importDefault(require(\"react\"));\n\nvar Mark_1 = __importDefault(require(\"./Mark\"));\n\nvar utils_1 = require(\"./utils\");\n\nvar Token = function (props) {\n  return react_1[\"default\"].createElement(\"span\", {\n    \"data-i\": props.i\n  }, props.content, \" \");\n};\n\nvar TokenAnnotator = function (props) {\n  var renderMark = props.renderMark || function (props) {\n    return react_1[\"default\"].createElement(Mark_1[\"default\"], __assign({}, props));\n  };\n\n  var getSpan = function (span) {\n    if (props.getSpan) return props.getSpan(span);\n    return {\n      start: span.start,\n      end: span.end\n    };\n  };\n\n  var handleMouseUp = function () {\n    var _a;\n\n    if (!props.onChange) return;\n    var selection = window.getSelection();\n    if (utils_1.selectionIsEmpty(selection)) return;\n\n    if (!selection.anchorNode.parentElement.hasAttribute('data-i') || !selection.focusNode.parentElement.hasAttribute('data-i')) {\n      window.getSelection().empty();\n      return false;\n    }\n\n    var start = parseInt(selection.anchorNode.parentElement.getAttribute('data-i'), 10);\n    var end = parseInt(selection.focusNode.parentElement.getAttribute('data-i'), 10);\n\n    if (utils_1.selectionIsBackwards(selection)) {\n      ;\n      _a = [end, start], start = _a[0], end = _a[1];\n    }\n\n    end += 1;\n    props.onChange(__spreadArrays(props.value, [getSpan({\n      start: start,\n      end: end,\n      tokens: props.tokens.slice(start, end)\n    })]));\n    window.getSelection().empty();\n  };\n\n  var handleSplitClick = function (_a) {\n    var start = _a.start,\n        end = _a.end; // Find and remove the matching split.\n\n    var splitIndex = props.value.findIndex(function (s) {\n      return s.start === start && s.end === end;\n    });\n\n    if (splitIndex >= 0) {\n      props.onChange(__spreadArrays(props.value.slice(0, splitIndex), props.value.slice(splitIndex + 1)));\n    }\n  };\n\n  var tokens = props.tokens,\n      value = props.value,\n      onChange = props.onChange,\n      _ = props.getSpan,\n      divProps = __rest(props, [\"tokens\", \"value\", \"onChange\", \"getSpan\"]);\n\n  var splits = utils_1.splitTokensWithOffsets(tokens, value);\n  return react_1[\"default\"].createElement(\"div\", __assign({}, divProps, {\n    onMouseUp: handleMouseUp\n  }), splits.map(function (split, i) {\n    return split.mark ? renderMark(__assign(__assign({\n      key: split.start + \"-\" + split.end\n    }, split), {\n      onClick: handleSplitClick\n    })) : react_1[\"default\"].createElement(Token, __assign({\n      key: split.i\n    }, split));\n  }));\n};\n\nexports[\"default\"] = TokenAnnotator;","map":{"version":3,"sources":["../src/TokenAnnotator.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nexports.__esModule = true;\nvar react_1 = __importDefault(require(\"react\"));\nvar Mark_1 = __importDefault(require(\"./Mark\"));\nvar utils_1 = require(\"./utils\");\nvar Token = function (props) {\n    return react_1[\"default\"].createElement(\"span\", { \"data-i\": props.i },\n        props.content,\n        \" \");\n};\nvar TokenAnnotator = function (props) {\n    var renderMark = props.renderMark || (function (props) { return react_1[\"default\"].createElement(Mark_1[\"default\"], __assign({}, props)); });\n    var getSpan = function (span) {\n        if (props.getSpan)\n            return props.getSpan(span);\n        return { start: span.start, end: span.end };\n    };\n    var handleMouseUp = function () {\n        var _a;\n        if (!props.onChange)\n            return;\n        var selection = window.getSelection();\n        if (utils_1.selectionIsEmpty(selection))\n            return;\n        if (!selection.anchorNode.parentElement.hasAttribute('data-i') ||\n            !selection.focusNode.parentElement.hasAttribute('data-i')) {\n            window.getSelection().empty();\n            return false;\n        }\n        var start = parseInt(selection.anchorNode.parentElement.getAttribute('data-i'), 10);\n        var end = parseInt(selection.focusNode.parentElement.getAttribute('data-i'), 10);\n        if (utils_1.selectionIsBackwards(selection)) {\n            ;\n            _a = [end, start], start = _a[0], end = _a[1];\n        }\n        end += 1;\n        props.onChange(__spreadArrays(props.value, [getSpan({ start: start, end: end, tokens: props.tokens.slice(start, end) })]));\n        window.getSelection().empty();\n    };\n    var handleSplitClick = function (_a) {\n        var start = _a.start, end = _a.end;\n        // Find and remove the matching split.\n        var splitIndex = props.value.findIndex(function (s) { return s.start === start && s.end === end; });\n        if (splitIndex >= 0) {\n            props.onChange(__spreadArrays(props.value.slice(0, splitIndex), props.value.slice(splitIndex + 1)));\n        }\n    };\n    var tokens = props.tokens, value = props.value, onChange = props.onChange, _ = props.getSpan, divProps = __rest(props, [\"tokens\", \"value\", \"onChange\", \"getSpan\"]);\n    var splits = utils_1.splitTokensWithOffsets(tokens, value);\n    return (react_1[\"default\"].createElement(\"div\", __assign({}, divProps, { onMouseUp: handleMouseUp }), splits.map(function (split, i) {\n        return split.mark ? (renderMark(__assign(__assign({ key: split.start + \"-\" + split.end }, split), { onClick: handleSplitClick }))) : (react_1[\"default\"].createElement(Token, __assign({ key: split.i }, split)));\n    })));\n};\nexports[\"default\"] = TokenAnnotator;\n//# sourceMappingURL=TokenAnnotator.js.map"]},"metadata":{},"sourceType":"script"}